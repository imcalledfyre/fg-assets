<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Fyre Network Launcher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Fyre Network Launcher — clean, Mojang-style launcher for Desktop and Chromebook editions." />
    <style>
        :root {
            --bg: #171a1c;
            --panel: #202428;
            --panel-2: #262b30;
            --panel-3: #2b3137;
            --text: #e9eef2;
            --muted: #a8b3bd;
            --accent: #2ecc71;
            /* Play button green */
            --accent-2: #1abc9c;
            /* Accent hover */
            --warn: #f1c40f;
            --error: #e74c3c;
            --ok: #2ecc71;
            --focus: #4aa3ff;
            --brand: #6cc644;
            /* Subtle Minecraft-ish green */
            --shadow: 0 20px 60px rgba(0, 0, 0, .45);
            --radius: 10px;
            --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            --ui: Inter, system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            font-family: var(--ui);
            color: var(--text);
            background:
                radial-gradient(1800px 800px at 10% 0%, #0e1113 0%, transparent 60%),
                radial-gradient(1200px 800px at 100% 100%, #0f1316 0%, transparent 55%),
                linear-gradient(180deg, #0f1316, var(--bg) 40%);
            display: grid;
            place-items: center;
        }

        /* Window frame */
        .frame {
            width: 860px;
            max-width: calc(100vw - 24px);
            background: linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
            border-radius: 14px;
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 1px solid #1b1f23;
        }

        .titlebar {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: linear-gradient(180deg, #1c2023 0%, #181c1f 100%);
            border-bottom: 1px solid #111416;
            letter-spacing: .2px;
        }

        .titlebar .dots {
            display: inline-flex;
            gap: 8px;
        }

        .titlebar .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #3a3f45;
            box-shadow: inset 0 0 0 1px #0f1112;
        }

        .titlebar .name {
            font-weight: 600;
            color: var(--text);
        }

        .titlebar .spacer {
            flex: 1;
        }

        .titlebar .badge {
            font-size: 12px;
            background: #1a1e21;
            border: 1px solid #0f1214;
            padding: 4px 8px;
            border-radius: 6px;
            color: var(--muted);
        }

        .content {
            display: grid;
            grid-template-columns: 1.4fr 1fr;
            gap: 16px;
            padding: 18px;
        }

        /* Left: main controls */
        .panel {
            background: linear-gradient(180deg, var(--panel-2), var(--panel-3));
            border: 1px solid #1b1f23;
            border-radius: var(--radius);
            padding: 16px;
            box-shadow: inset 0 0 0 1px #1c2126;
        }

        .panel h2 {
            margin: 0 0 12px 0;
            font-size: 16px;
            font-weight: 600;
            color: #dbe6ee;
            letter-spacing: .3px;
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            align-items: end;
        }

        /* Segmented control for edition */
        .seg {
            display: grid;
            grid-template-columns: 1fr 1fr;
            background: #1b2024;
            border: 1px solid #121618;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .seg input {
            display: none;
        }

        .seg label {
            padding: 10px 12px;
            text-align: center;
            font-size: 14px;
            color: var(--muted);
            cursor: pointer;
            user-select: none;
            transition: color .15s ease;
        }

        .seg input:checked+label {
            color: #eaf6ef;
            font-weight: 600;
        }

        .seg .slider {
            position: absolute;
            top: 4px;
            bottom: 4px;
            width: calc(50% - 8px);
            background: linear-gradient(180deg, #263038, #1e252a);
            border: 1px solid #111417;
            border-radius: 6px;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, .04);
            transition: transform .18s ease;
        }

        /* position via data-selected attr */
        .seg[data-selected="desktop"] .slider {
            transform: translateX(4px);
        }

        .seg[data-selected="chromebook"] .slider {
            transform: translateX(calc(100% + 4px));
        }

        /* Select */
        .field label {
            display: block;
            margin: 0 0 6px 0;
            font-size: 12px;
            color: var(--muted);
            letter-spacing: .2px;
        }

        select {
            width: 100%;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid #121518;
            background: #1a1e22;
            color: var(--text);
            outline: none;
            transition: border-color .15s ease, box-shadow .15s ease;
            appearance: none;
            background-image:
                linear-gradient(45deg, transparent 50%, #7f8a94 50%),
                linear-gradient(135deg, #7f8a94 50%, transparent 50%);
            background-position:
                calc(100% - 18px) calc(50% - 3px),
                calc(100% - 12px) calc(50% - 3px);
            background-size: 6px 6px, 6px 6px;
            background-repeat: no-repeat;
        }

        select:focus {
            border-color: var(--focus);
            box-shadow: 0 0 0 3px rgba(74, 163, 255, .2);
        }

        /* Play button */
        .actions {
            margin-top: 14px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .play {
            flex: 1;
            padding: 14px 16px;
            border: 0;
            border-radius: 10px;
            background: linear-gradient(180deg, #31d477, var(--accent));
            color: #0c140e;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: .6px;
            cursor: pointer;
            box-shadow:
                0 10px 20px rgba(46, 204, 113, .25),
                inset 0 -2px 0 rgba(0, 0, 0, .2);
            transition: transform .06s ease, filter .15s ease, box-shadow .15s ease;
        }

        .play:hover {
            filter: brightness(1.03);
        }

        .play:active {
            transform: translateY(1px);
        }

        .play[disabled] {
            opacity: .6;
            cursor: not-allowed;
            filter: saturate(.2);
            box-shadow: inset 0 -2px 0 rgba(0, 0, 0, .25);
        }

        .hint {
            font-size: 12px;
            color: var(--muted);
            padding: 8px 10px;
            background: #14181b;
            border: 1px solid #0f1315;
            border-radius: 8px;
        }

        /* Right: status & notes */
        .stack {
            display: grid;
            gap: 12px;
        }

        .status {
            display: grid;
            gap: 10px;
            padding: 14px;
            background: #1a1f23;
            border: 1px solid #12161a;
            border-radius: 10px;
        }

        .kv {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            font-size: 14px;
        }

        .pill {
            padding: 4px 8px;
            border-radius: 999px;
            font-size: 12px;
            letter-spacing: .2px;
            border: 1px solid #0e1215;
            background: #12161a;
            color: var(--muted);
        }

        .pill.ok {
            background: rgba(46, 204, 113, .12);
            color: #bff3d5;
            border-color: rgba(46, 204, 113, .25);
        }

        .pill.warn {
            background: rgba(241, 196, 15, .12);
            color: #fdeeb7;
            border-color: rgba(241, 196, 15, .25);
        }

        .pill.error {
            background: rgba(231, 76, 60, .12);
            color: #ffc9c4;
            border-color: rgba(231, 76, 60, .25);
        }

        .notes {
            padding: 14px;
            background: #1a1f23;
            border: 1px solid #12161a;
            border-radius: 10px;
        }

        .notes h3 {
            margin: 0 0 8px 0;
            font-size: 14px;
            letter-spacing: .2px;
            color: #d7e1ea;
        }

        .notes p {
            margin: 0;
            color: var(--muted);
            font-size: 13px;
            line-height: 1.4;
        }

        /* Footer bar */
        .footer {
            margin: 12px 18px 18px;
            padding: 10px 12px;
            border: 1px dashed #2a3238;
            border-radius: 8px;
            color: #a8b3bd;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer code {
            font-family: var(--mono);
            color: #c6d2db;
        }

        /* Modal */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, .7);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 18px;
            z-index: 50;
        }

        .modal {
            width: 580px;
            max-width: 100%;
            background: #1a2024;
            border: 1px solid #0e1215;
            border-radius: 12px;
            box-shadow: var(--shadow);
            overflow: hidden;
            animation: pop .14s ease-out;
        }

        @keyframes pop {
            from {
                transform: scale(.98);
                opacity: .6;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal header {
            padding: 14px 16px;
            background: #151a1d;
            border-bottom: 1px solid #0f1316;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal header h3 {
            margin: 0;
            font-size: 15px;
        }

        .modal .body {
            padding: 14px 16px;
            color: var(--muted);
            font-size: 14px;
        }

        .modal .body ol {
            margin: 10px 0 0 18px;
        }

        .modal .body li {
            margin: 6px 0;
        }

        .modal footer {
            padding: 12px 16px;
            background: #13181b;
            border-top: 1px solid #0f1316;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn {
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid #0f1316;
            background: #1a2024;
            color: var(--text);
            cursor: pointer;
            transition: filter .12s ease, background .12s ease, border-color .12s ease;
        }

        .btn:hover {
            filter: brightness(1.05);
        }

        .btn.primary {
            background: linear-gradient(180deg, #2b8cff, #1f74e6);
            border-color: #1359b3;
            color: #07101a;
            font-weight: 700;
        }

        /* Accessibility */
        :focus-visible {
            outline: 3px solid rgba(74, 163, 255, .35);
            outline-offset: 2px;
            border-radius: 8px;
        }

        @media (max-width: 820px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <main class="frame" role="application" aria-label="Fyre Network Launcher">
        <div class="titlebar" aria-hidden="true">
            <div class="dots" aria-hidden="true">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
            <div class="name">Fyre Network Launcher</div>
            <div class="spacer"></div>
            <div class="badge">Not affiliated with Mojang</div>
        </div>

        <section class="content">
            <!-- Left column -->
            <section class="panel" aria-labelledby="play-panel-title">
                <h2 id="play-panel-title">Play</h2>

                <div class="controls" aria-live="polite">
                    <div class="field" style="grid-column: span 2;">
                        <label id="edition-label">Edition</label>
                        <div class="seg" id="editionSeg" data-selected="desktop" role="radiogroup" aria-labelledby="edition-label">
                            <input type="radio" name="edition" id="ed-desktop" value="desktop" checked />
                            <label for="ed-desktop" role="radio" aria-checked="true">Desktop</label>

                            <input type="radio" name="edition" id="ed-chromebook" value="chromebook" />
                            <label for="ed-chromebook" role="radio" aria-checked="false">Chromebook</label>

                            <div class="slider" aria-hidden="true"></div>
                        </div>
                    </div>

                    <div class="field">
                        <label for="version">Version</label>
                        <select id="version" aria-label="Version">
                            <option value="18" selected>1.8</option>
                            <option value="112">1.12</option>
                        </select>
                    </div>

                    <div class="field">
                        <label>&nbsp;</label>
                        <button class="play" id="playBtn" aria-label="Play">Play</button>
                    </div>
                </div>

                <div class="actions">
                    <div class="hint" id="hintBox">
                        Tip: Chromebook edition requires WebAssembly. We’ll guide you if it isn’t enabled.
                    </div>
                </div>
            </section>

            <!-- Right column -->
            <div class="stack" aria-live="polite">
                <section class="status" aria-labelledby="status-title">
                    <h2 id="status-title" style="margin:0;font-size:14px;color:#e1ebf3;font-weight:600;">Status</h2>
                    <div class="kv">
                        <span>Detected OS</span>
                        <span class="pill" id="osPill">Checking…</span>
                    </div>
                    <div class="kv">
                        <span>WebAssembly</span>
                        <span class="pill" id="wasmPill">Checking…</span>
                    </div>
                    <div class="kv">
                        <span>Edition</span>
                        <span class="pill" id="editionPill">Desktop</span>
                    </div>
                    <div class="kv">
                        <span>Version</span>
                        <span class="pill" id="versionPill">1.8</span>
                    </div>
                </section>

                <section class="notes" aria-labelledby="notes-title">
                    <h3 id="notes-title">Notes</h3>
                    <p>Defaulting to version 1.8. You can switch to 1.12 anytime. Your last choice is remembered on this device.</p>
                </section>
            </div>
        </section>

        <div class="footer" role="contentinfo">
            Need Chromebook WASM help? Open chrome://flags, search “WASM”, enable related flags, then restart your browser/computer.
            <code>chrome://flags</code>
        </div>
    </main>

    <!-- Modal: WASM help -->
    <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc">
        <div class="modal">
            <header>
                <h3 id="modalTitle">Enable WebAssembly for Chromebook edition</h3>
                <button class="btn" id="closeModal" aria-label="Close">Close</button>
            </header>
            <div class="body" id="modalDesc">
                <p>It looks like WebAssembly isn’t available. To enable it in Chrome:</p>
                <ol>
                    <li>Type <strong>chrome://flags</strong> in the address bar and press Enter.</li>
                    <li>Search for <strong>WASM</strong> and enable WebAssembly-related flags.</li>
                    <li>Click <strong>Relaunch</strong> (or restart your computer) to apply changes.</li>
                </ol>
                <p style="margin-top:10px;">When you’re back, click “Re-check” below. We’ll unlock Chromebook edition automatically.</p>
            </div>
            <footer>
                <button class="btn" id="recheckBtn">Re-check</button>
                <button class="btn primary" id="openFlagsBtn" title="Opens a new tab to chrome://flags">Open flags</button>
            </footer>
        </div>
    </div>

    <script>
        // Elements
        const editionSeg = document.getElementById('editionSeg');
        const edDesktopInp = document.getElementById('ed-desktop');
        const edChromebookInp = document.getElementById('ed-chromebook');
        const versionSel = document.getElementById('version');
        const playBtn = document.getElementById('playBtn');

        const osPill = document.getElementById('osPill');
        const wasmPill = document.getElementById('wasmPill');
        const editionPill = document.getElementById('editionPill');
        const versionPill = document.getElementById('versionPill');
        const hintBox = document.getElementById('hintBox');

        const modalBackdrop = document.getElementById('modalBackdrop');
        const closeModalBtn = document.getElementById('closeModal');
        const recheckBtn = document.getElementById('recheckBtn');
        const openFlagsBtn = document.getElementById('openFlagsBtn');

        // Utilities
        function setPill(el, text, cls) {
            el.textContent = text;
            el.className = 'pill' + (cls ? ' ' + cls : '');
        }

        function detectOS() {
            // Prefer UA-CH if available
            try {
                const ua = navigator.userAgent || '';
                const isCrOS = /CrOS/.test(ua);
                if (isCrOS) return 'Chrome OS';
            } catch {}
            // UA-CH hint (best effort)
            const anyPlatform = (navigator.userAgentData && navigator.userAgentData.platform) || navigator.platform || '';
            if (/^Chrome OS$/i.test(anyPlatform)) return 'Chrome OS';
            if (/Win/i.test(anyPlatform)) return 'Windows';
            if (/Mac/i.test(anyPlatform)) return 'macOS';
            if (/Linux/i.test(anyPlatform)) return 'Linux';
            return 'Unknown';
        }

        function hasWasm() {
            if (typeof WebAssembly !== 'object') return false;
            try {
                const bytes = new Uint8Array([0x00, 0x61, 0x73, 0x6D, 0x01, 0x00, 0x00, 0x00]);
                return WebAssembly.validate(bytes);
            } catch {
                return false;
            }
        }

        function updateSegment(selected) {
            editionSeg.dataset.selected = selected;
            edDesktopInp.checked = selected === 'desktop';
            edChromebookInp.checked = selected === 'chromebook';
            editionPill.textContent = selected === 'desktop' ? 'Desktop' : 'Chromebook';
            localStorage.setItem('fyre_edition', selected);
        }

        function updateVersionPill() {
            versionPill.textContent = versionSel.value === '18' ? '1.8' : '1.12';
            localStorage.setItem('fyre_version', versionSel.value);
        }

        function showModal() {
            modalBackdrop.style.display = 'flex';
        }

        function hideModal() {
            modalBackdrop.style.display = 'none';
        }

        function applyAutoSelect(os, wasmEnabled) {
            const savedEdition = localStorage.getItem('fyre_edition');
            const savedVersion = localStorage.getItem('fyre_version');

            // Start on 1.8 by default
            versionSel.value = savedVersion || '18';
            updateVersionPill();

            // Auto-select Chromebook on Chrome OS, else Desktop — unless user saved a preference
            let targetEdition = savedEdition || ((os === 'Chrome OS') ? 'chromebook' : 'desktop');
            updateSegment(targetEdition);

            // If Chromebook selected but WASM off, show guidance
            if (targetEdition === 'chromebook' && !wasmEnabled) {
                setTimeout(showModal, 300);
                hintBox.textContent = 'Chromebook selected. WebAssembly is required — follow the steps to enable it.';
            }
        }

        function computeUrl() {
            const edition = edChromebookInp.checked ? 'cb' : 'd';
            const version = versionSel.value; // "18" or "112"
            return `/fyrecraft/${edition}${version}.html`;
        }

        // Init
        (function init() {
            const os = detectOS();
            const wasmEnabled = hasWasm();

            setPill(osPill, os, (os === 'Chrome OS') ? 'ok' : '');
            setPill(wasmPill, wasmEnabled ? 'Enabled' : 'Disabled', wasmEnabled ? 'ok' : 'error');

            applyAutoSelect(os, wasmEnabled);

            // Events
            editionSeg.addEventListener('click', (e) => {
                if (e.target.tagName === 'LABEL') {
                    const value = e.target.getAttribute('for') === 'ed-chromebook' ? 'chromebook' : 'desktop';
                    updateSegment(value);

                    // If switching to Chromebook without WASM, block play and show modal
                    if (value === 'chromebook' && !hasWasm()) {
                        hintBox.textContent = 'Chromebook edition needs WebAssembly. Let’s enable it — see steps.';
                        showModal();
                    } else {
                        hintBox.textContent = 'Tip: Chromebook edition requires WebAssembly. We’ll guide you if it isn’t enabled.';
                    }
                }
            });

            versionSel.addEventListener('change', updateVersionPill);

            playBtn.addEventListener('click', () => {
                const wantsChromebook = edChromebookInp.checked;
                if (wantsChromebook && !hasWasm()) {
                    showModal();
                    return;
                }
                const url = computeUrl();
                // Small press feedback
                playBtn.disabled = true;
                playBtn.textContent = 'Launching…';
                setTimeout(() => {
                    window.location.href = url;
                }, 200);
            });

            // Keyboard enter triggers play
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.altKey && !e.ctrlKey && !e.metaKey && !e.shiftKey) {
                    playBtn.click();
                }
            });

            // Modal controls
            closeModalBtn.addEventListener('click', hideModal);
            modalBackdrop.addEventListener('click', (e) => {
                if (e.target === modalBackdrop) hideModal();
            });
            recheckBtn.addEventListener('click', () => {
                const ok = hasWasm();
                setPill(wasmPill, ok ? 'Enabled' : 'Disabled', ok ? 'ok' : 'error');
                if (ok) {
                    hintBox.textContent = 'WebAssembly detected. Chromebook edition unlocked.';
                    hideModal();
                } else {
                    alert('Still off — enable WASM in chrome://flags and restart the browser/computer.');
                }
            });
            openFlagsBtn.addEventListener('click', () => {
                // Best-effort: some browsers block non-http(s) window.open. We try and also show the url.
                try {
                    window.open('chrome://flags', '_blank');
                } catch {}
                alert('In the new tab, search for "WASM", enable related flags, then relaunch.');
            });
        })();
    </script>
</body>

</html>
